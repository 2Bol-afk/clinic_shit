{% extends 'base.html' %}
{% block content %}
<h3 class="mb-3">{% if is_edit %}Edit Doctor{% else %}Add Doctor{% endif %}</h3>
<div class="card shadow-sm">
  <div class="card-body">
    <form method="post">
      {% csrf_token %}
      <div class="row g-3">
        <div class="col-md-6">
          <label class="form-label">Full Name</label>
          <input type="text" class="form-control" name="full_name" required value="{{ form.full_name.value|default:'' }}">
          {% if form.full_name.errors %}<div class="text-danger small">{% for e in form.full_name.errors %}{{ e }}{% endfor %}</div>{% endif %}
        </div>
        <div class="col-md-6">
          <label class="form-label">Department</label>
          <select class="form-select" name="specialization" required>
            {% for val,label in form.fields.specialization.choices %}
              <option value="{{ val }}" {% if form.specialization.value == val %}selected{% endif %}>{{ label }}</option>
            {% endfor %}
          </select>
          {% if form.specialization.errors %}<div class="text-danger small">{% for e in form.specialization.errors %}{{ e }}{% endfor %}</div>{% endif %}
        </div>
        <div class="col-md-6">
          <label class="form-label">Email</label>
          <input type="email" class="form-control" name="email" required value="{{ form.email.value|default:'' }}">
          {% if form.email.errors %}<div class="text-danger small">{% for e in form.email.errors %}{{ e }}{% endfor %}</div>{% endif %}
        </div>
        <div class="col-md-6">
          <label class="form-label">Password</label>
          <div class="input-group">
            <input type="password" class="form-control" name="password" id="password" placeholder="{% if is_edit %}Leave blank to keep current{% else %}Set an initial password{% endif %}">
            <button class="btn btn-outline-secondary" type="button" id="togglePassword" onclick="togglePasswordVisibility()">
              <i class="bi bi-eye" id="toggleIcon"></i>
            </button>
          </div>
          {% if form.password.errors %}<div class="text-danger small">{% for e in form.password.errors %}{{ e }}{% endfor %}</div>{% endif %}
        </div>
      </div>
      <div class="mt-3 d-flex gap-2">
        <button class="btn btn-primary" type="submit">Save</button>
        <a class="btn btn-secondary" href="/dashboard/doctors/">Cancel</a>
      </div>
    </form>
  </div>
</div>

<script>
function togglePasswordVisibility() {
  const passwordInput = document.getElementById('password');
  const toggleIcon = document.getElementById('toggleIcon');
  
  if (passwordInput.type === 'password') {
    passwordInput.type = 'text';
    toggleIcon.className = 'bi bi-eye-slash';
  } else {
    passwordInput.type = 'password';
    toggleIcon.className = 'bi bi-eye';
  }
}
</script>
{% endblock %}
