{% extends 'base.html' %}

{% block content %}
<h4 class="mb-3">Edit Reception Entry</h4>
<div class="card shadow-sm">
  <div class="card-body">
    <form method="post">
      {% csrf_token %}
      <div class="row g-3">
        <div class="col-md-4">
          <label class="form-label">Visit Type</label>
          <select class="form-select" id="receptionVisitType" name="reception_visit_type">
            <option value="consultation" {% if visit.department %}selected{% endif %}>Consultation</option>
            <option value="laboratory" {% if not visit.department %}selected{% endif %}>Laboratory</option>
            <option value="vaccination">Vaccination</option>
          </select>
        </div>
        <div class="col-md-4" id="queueWrap">
          <label class="form-label">Queue Number</label>
          <input type="number" name="queue_number" class="form-control" value="{{ visit.queue_number|default:'' }}">
        </div>
        <div class="col-md-4" id="deptWrap">
          <label class="form-label">Department</label>
          <select class="form-select" name="department">
            <option value="">-- None --</option>
            <option value="Pediatrics" {% if visit.department == 'Pediatrics' %}selected{% endif %}>Pediatrics (Children’s Health)</option>
            <option value="OB-GYN" {% if visit.department == 'OB-GYN' %}selected{% endif %}>Obstetrics and Gynecology (OB-GYN)</option>
            <option value="Cardiology" {% if visit.department == 'Cardiology' %}selected{% endif %}>Cardiology (Heart Care)</option>
            <option value="Radiology" {% if visit.department == 'Radiology' %}selected{% endif %}>Radiology</option>
            <option value="Surgery" {% if visit.department == 'Surgery' %}selected{% endif %}>Surgery</option>
            <option value="Dermatology" {% if visit.department == 'Dermatology' %}selected{% endif %}>Dermatology (Skin Care)</option>
            <option value="ENT" {% if visit.department == 'ENT' %}selected{% endif %}>ENT (Ear, Nose, Throat)</option>
          </select>
        </div>
        <div class="col-12">
          <label class="form-label">Notes</label>
          <textarea name="notes" class="form-control" rows="3">{{ visit.notes }}</textarea>
        </div>
      </div>
      <div class="mt-3 d-flex gap-2">
        <button class="btn btn-success" type="submit"><i class="bi bi-check2-circle me-1"></i>Save</button>
        <a class="btn btn-secondary" href="/dashboard/reception/">Cancel</a>
      </div>
    </form>
  </div>
  <div class="card-footer text-muted small">
    Patient: <a href="/patients/{{ visit.patient.id }}/">{{ visit.patient.full_name }}</a> · Logged {{ visit.timestamp|date:'Y-m-d H:i' }}
  </div>
</div>
<script>
(function(){
  const typeSel = document.getElementById('receptionVisitType');
  const dept = document.getElementById('deptWrap');
  const q = document.getElementById('queueWrap');
  function sync(){
    const isConsult = typeSel && typeSel.value === 'consultation';
    if(dept) dept.style.display = isConsult ? '' : 'none';
    if(q) q.style.display = isConsult ? '' : 'none';
  }
  if(typeSel){ typeSel.addEventListener('change', sync); sync(); }
})();
</script>
{% endblock %}


